---
title: 'IP Set'
---

## Overview

An ip set reserves a public IP address for each location configured within a Global Virtual Cloud ([GVC](/objects/gvc)). The public IP address is stored in the objectâ€™s status. When a new location is added to a GVC, a new IP address is automatically created if one does not already exist for that location.
To prevent ongoing charges, IP addresses must be explicitly released once they are no longer needed.

## Binding

An IP Set can be linked to a [workload](/objects/workload) through its `spec.link` property. When linking to a workload, the workload must have [direct load balancer](/objects/workload/load-balancing#direct-load-balancer) enabled. A workload MUST link to an IP Set via its direct load balancer. The IP Set will only function if the cross-linking is properly configured workload and IP Set link to each other.

### Linking to Workload from IP Set

```json
{
  "kind": "ipSet",
  "name": "example",
  "spec": {
    "link": "/org/example-org/gvc/example-gvc/workload/example-workload",
    "locations": [
      {
        "name": "//location/aws-us-west-2",
        "retentionPolicy": "keep"
      }
    ]
  }
}
```

### Linking to IP Set from Workload

```json
{
  "spec": {
    "containers": [
      {
        "name": "advanced-options-example",
        "args": [],
        "cpu": "50m",
        "env": [],
        "image": "kennethreitz/httpbin:latest",
        "memory": "128Mi",
        "port": 8080
      }
    ],
    "loadBalancer": {
      "direct": {
        "enabled": true,
        "ipSet": "/org/example-org/ipset/example",
        "ports": [
          {
            "externalPort": 443,
            "protocol": "TCP",
            "containerPort": 8080
          }
        ]
      }
    }
  }
}
```

## Releasing

To delete an IP address from a location, you can set the `retentionPolicy` field
for the specific location to `"free"`.

<Note>An IP address will not be released unless it is no longer in use (no workload is linked, gvc location not active, etc.)</Note>

### Example

```json
{
  "kind": "ipSet",
  "name": "example",
  "spec": {
    "link": "/org/example-org/gvc/example-gvc/workload/example-workload",
    "locations": [
      {
        "name": "//location/aws-us-west-2",
        "retentionPolicy": "free"
      }
    ]
  }
}
```

## Status

Once the IP Set is initialized, its status will be updated with the new IP address(es).

### Example

```json
{
  "kind": "ipSet",
  "name": "example",
  "spec": {
    "link": "/org/example-org/gvc/example-gvc/workload/example-workload",
    "locations": [
      {
        "name": "//location/aws-us-west-2",
        "retentionPolicy": "keep"
      }
    ]
  },
  "status": {
    "ipAddresses": [
      {
        "name": "//location/aws-us-west-2",
        "ip": "10.20.30.40",
        "id": "eipalloc-0a1b2c3d4e5f67890",
        "state": "bound",
        "created": "2024-07-30T14:18:36.327Z"
      }
    ]
  }
}
```

## Permissions

The permissions below are used to define [policies](/objects/policy) together with one or more of the four
[principal types](/platform/access-control):

| Permission | Description               | Implies                            |
| :--------- | :------------------------ | :--------------------------------- |
| create     | Create new ip sets        |                                    |
| delete     | Delete ip sets            |                                    |
| edit       | Modify existing resources | view                               |
| manage     | Full access               | create, delete, edit, manage, view |
| view       | Read-only access          |                                    |

## API Reference

Click to see [API Agent Reference](/api-reference/agent)

## CLI Reference

Click to see [CLI Agent Reference](/references/cli/agent)

## Terraform Reference

Click to see [Terraform Agent Resource](/references/terraform/resources/cpln_gvc)

Click to see [Terraform Agent Data Source](/references/terraform/data-sources/cpln_gvc)
