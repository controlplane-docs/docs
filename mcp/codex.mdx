---
title: OpenAI Codex
sidebarTitle: Codex
description: Configure the Control Plane MCP Server for OpenAI Codex
---

Connect OpenAI Codex to Control Plane to manage your infrastructure through AI-assisted development.

## Prerequisites

<CardGroup cols={2}>
  <Card title="OpenAI Codex" icon="download">
    Install [Codex CLI](https://openai.com/codex)
  </Card>
  <Card title="Service Account Token" icon="key">
    Create a [service account](/guides/create-service-account) with appropriate permissions
  </Card>
</CardGroup>

<Note>
  For the latest MCP configuration options, refer to the official [OpenAI Codex documentation](https://developers.openai.com/codex).
</Note>

## Configuration

### Step 1: Set the Environment Variable

Add your service account token as an environment variable:

<Tabs>
  <Tab title="macOS/Linux">
    ```bash
    export CPLN_TOKEN="<your-service-account-token>"
    ```

    Add this line to `~/.bashrc`, `~/.zshrc`, or your shell configuration file, then reload your shell or run `source ~/.zshrc`.
  </Tab>

  <Tab title="Windows">
    ```powershell
    [System.Environment]::SetEnvironmentVariable('CPLN_TOKEN', '<your-service-account-token>', 'User')
    ```

    Or set it via **System Properties → Environment Variables → User variables**.

    Restart your terminal after setting the variable.
  </Tab>
</Tabs>

<Warning>
  Replace `<your-service-account-token>` with your actual service account token.
</Warning>

### Step 2: Add the MCP Server

Use the `codex mcp add` command to register the Control Plane MCP Server:

```bash
codex mcp add cpln --url https://mcp.cpln.io/mcp --bearer-token-env-var CPLN_TOKEN
```

### Step 3: Verify the Connection

List your configured MCP servers to confirm the setup:

```bash
codex mcp list
```

You should see `cpln` in the list of configured servers.

### Managing MCP Servers

```bash
# List all MCP servers
codex mcp list

# Show details for a server
codex mcp get cpln

# Remove an MCP server
codex mcp remove cpln

# Get help on MCP commands
codex mcp --help
```

## Example Usage

<Steps>
  <Step title="Set Context">
    ```
    Use org "my-org" and gvc "my-gvc" for context.
    ```
  </Step>
  <Step title="Deploy a Workload">
    ```
    Create a publicly accessible workload called "my-api" using nginx:latest on port 80.
    ```
  </Step>
  <Step title="Get the Endpoint">
    ```
    Monitor the readiness of my-api and give me the public endpoint once it's ready.
    ```
  </Step>
</Steps>

## Troubleshooting

<AccordionGroup>
  <Accordion title="Authentication errors">
    - Ensure the `CPLN_TOKEN` environment variable is set in your shell.
    - Check that your service account token is valid.
    - Ensure the token is entered without extra spaces or quotes.
    - Verify the token has appropriate permissions (see [Service Account Permissions](/mcp/overview#service-account-permissions)).
    - **Check for typos in the org name** you're using for context, this is a common cause of authentication failures.
  </Accordion>
</AccordionGroup>

## Next Steps

<CardGroup cols={2}>
  <Card title="Usage Examples" icon="lightbulb" href="/mcp/examples">
    See practical examples of Control Plane operations
  </Card>
  <Card title="Policy Reference" icon="shield" href="/reference/policy">
    Learn about permissions and access control
  </Card>
</CardGroup>
