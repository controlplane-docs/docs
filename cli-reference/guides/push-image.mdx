---
title: Push Images to Registry
description: Build and push container images to Control Plane's private registry.
---

Push container images to your organization's private registry on Control Plane. Use Docker, the CLI, or any Docker-compatible client.

## When to use this

<CardGroup cols={2}>
  <Card title="CI/CD pipelines" icon="code">
    Build and push images in automated pipelines
  </Card>
  <Card title="Local development" icon="laptop">
    Push locally-built images for testing
  </Card>
  <Card title="Private registry" icon="key">
    Store images in your org's secure registry
  </Card>
  <Card title="No Dockerfile" icon="wand-magic-sparkles">
    Build automatically with buildpacks
  </Card>
</CardGroup>

## Prerequisites

<AccordionGroup>
<Accordion title="CLI installed">
  Install the Control Plane CLI. See [Installation](/cli-reference/installation).
</Accordion>

<Accordion title="Docker installed">
  Install [Docker](https://www.docker.com) with the Buildx plugin enabled.
</Accordion>

<Accordion title="Required permissions">
  You need push permission on images. See [Image Permissions](/reference/image#minimum-policy).
</Accordion>

<Accordion title="Docker Buildx enabled">
  Starting with CLI v3.7.2, `cpln image build` requires Docker Buildx.

  Verify Buildx is available:
  ```bash
  docker buildx version
  ```

  If not installed, add the plugin:
  ```bash
  BUILDX_VERSION=v0.29.1
  curl -sSL "https://github.com/docker/buildx/releases/download/${BUILDX_VERSION}/buildx-${BUILDX_VERSION}.linux-amd64" \
    | install -m 0755 -D /dev/stdin ~/.docker/cli-plugins/docker-buildx
  ```
</Accordion>
</AccordionGroup>

## Push with the CLI

The simplest way to build and push images:

<Tabs>
<Tab title="With Dockerfile">
  ```bash
  cpln image build --name my-app:v1 --push
  ```

  Or specify a Dockerfile:
  ```bash
  cpln image build --dockerfile ./Dockerfile --name my-app:v1 --push
  ```
</Tab>

<Tab title="With Buildpacks">
  Build automatically without a Dockerfile:
  ```bash
  cpln image build --name my-app:v1 --push
  ```

  Buildpacks detect your language and create an optimized image.
</Tab>
</Tabs>

## Push with Docker

<Steps>
<Step title="Authenticate Docker">
  Configure Docker to authenticate with your org's registry:

  ```bash
  cpln image docker-login
  ```

  <Tip>
  This uses your default CLI profile. Set `CPLN_PROFILE` to use a different profile.
  </Tip>
</Step>

<Step title="Build the image">
  Build with the correct tag format:

  ```bash
  docker buildx build --platform=linux/amd64 \
    -t my-org.registry.cpln.io/my-app:v1 .
  ```

  <Warning>
  Always target `linux/amd64` to ensure compatibility with Control Plane.
  </Warning>
</Step>

<Step title="Tag an existing image (optional)">
  If you have an existing image, tag it for your registry:

  ```bash
  docker tag my-app:v1 my-org.registry.cpln.io/my-app:v1
  ```
</Step>

<Step title="Push to registry">
  ```bash
  docker push my-org.registry.cpln.io/my-app:v1
  ```
</Step>
</Steps>

## Image name format

Images must use this format to push to your registry:

```
ORG_NAME.registry.cpln.io/IMAGE_NAME:TAG
```

Examples:
- `my-org.registry.cpln.io/api:v1.0.0`
- `my-org.registry.cpln.io/frontend:latest`
- `my-org.registry.cpln.io/worker:abc123`

## CI/CD authentication

For CI/CD pipelines without the CLI, authenticate with a service account:

```bash
echo $SERVICE_ACCOUNT_KEY | docker login my-org.registry.cpln.io -u '<token>' --password-stdin
```

| Parameter | Value |
|-----------|-------|
| Registry | `ORG_NAME.registry.cpln.io` |
| Username | `<token>` (literal string) |
| Password | Service account key |

<Warning>
Store the service account key securely. If compromised, delete and regenerate it.
</Warning>

See [Create a Service Account](/guides/create-service-account) for key generation.

## Use pushed images

Reference pushed images in workloads:

```yaml
containers:
  - name: my-container
    image: //image/my-app:v1
```

Or use the full path:
```yaml
containers:
  - name: my-container
    image: /org/my-org/image/my-app:v1
```

<Tip>
In the console, press `Ctrl+I` when configuring a workload to browse available images.
</Tip>

## Common workflows

### Build and deploy

```bash
# Build and push (Authenticates automatically)
cpln image build --name my-app:v1.2.3 --push

# Update workload
cpln workload update my-app --set spec.containers<container-name>.image=//image/my-app:v1.2.3
```

### CI/CD pipeline

```bash
# Build and push (Authenticates automatically)
cpln image build --name my-app:$CI_COMMIT_SHA --push

# Deploy (has the new image defined in the workload manifest container)
cpln apply --file workload.yaml
```

## Troubleshooting

<AccordionGroup>
<Accordion title="unknown shorthand flag: 'f' in -f">
  Docker Buildx is not installed. Install it:

  ```bash
  curl -sSL "https://github.com/docker/buildx/releases/download/v0.29.1/buildx-v0.29.1.linux-amd64" \
    | install -m 0755 -D /dev/stdin ~/.docker/cli-plugins/docker-buildx
  ```
</Accordion>

<Accordion title="Authentication failed or 403">
  Re-run `cpln image docker-login` to refresh credentials and double check that you don't have typos in the org name.
</Accordion>

<Accordion title="Push denied">
  Verify you have push permission on images. Check your policies or refresh your service account token.
</Accordion>

<Accordion title="Image too large">
  Optimize your Dockerfile:
  - Use multi-stage builds
  - Start from smaller base images
  - Remove unnecessary files
</Accordion>
</AccordionGroup>

## Next steps

<CardGroup cols={2}>
  <Card title="Pull Images" href="/cli-reference/guides/pull-image" icon="download">
    Configure workloads to pull images
  </Card>
  <Card title="Copy Images" href="/cli-reference/guides/copy-image" icon="copy">
    Copy images between organizations
  </Card>
  <Card title="Create a Workload" href="/guides/create-workload" icon="cube">
    Deploy your pushed images
  </Card>
  <Card title="Image Reference" href="/reference/image" icon="book">
    Image configuration details
  </Card>
</CardGroup>
