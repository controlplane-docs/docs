---
title: Install the Kubernetes Operator
description: Set up the Control Plane Kubernetes operator to manage resources from your K8s cluster.
---

The `cpln operator` command configures your Kubernetes cluster to work with the Control Plane operator. It creates the necessary secrets and service accounts for secure integration.

## When to use this

<CardGroup cols={2}>
  <Card title="ArgoCD integration" icon="arrows-rotate">
    Set up credentials so ArgoCD can deploy to Control Plane
  </Card>
  <Card title="Operator authentication" icon="key">
    Create the Kubernetes secret that grants operator access to your org
  </Card>
  <Card title="GitOps workflows" icon="code-branch">
    Enable Kubernetes-based CI/CD pipelines to manage Control Plane resources
  </Card>
  <Card title="Multi-cluster setup" icon="sitemap">
    Connect multiple Kubernetes clusters to a single Control Plane organization
  </Card>
</CardGroup>

## Prerequisites

<AccordionGroup>
<Accordion title="CLI installed">
  Install the Control Plane CLI. See [Installation](/cli-reference/installation).
</Accordion>

<Accordion title="Kubernetes access">
  You need access to a Kubernetes cluster with permissions to create namespaces and secrets.
</Accordion>

<Accordion title="kubectl configured">
  Ensure `kubectl` is configured and can communicate with your cluster.
</Accordion>
</AccordionGroup>

## Install the operator

Create the Kubernetes secret that grants the operator access to your organization:

```bash
cpln operator install --serviceaccount <name>
```

### Options

| Option | Description |
|--------|-------------|
| `--serviceaccount, -s` | Service account name for the operator (required) |
| `--serviceaccount-group, -g` | Group to assign the service account to (default: `superusers`) |
| `--export` | Output resources to stdout instead of applying them |

### Basic installation

```bash
cpln operator install \
  --serviceaccount k8s-operator \
  --org my-org
```

This command:
1. Creates the service account `k8s-operator` if it doesn't exist
2. Assigns it to the `superusers` group
3. Generates an authentication key
4. Creates a Kubernetes secret in the `controlplane` namespace

### Specify a group

Assign the service account to a specific group:

```bash
cpln operator install \
  --serviceaccount k8s-operator \
  --serviceaccount-group operators \
  --org my-org
```

<Tip>
Use a group with limited permissions for production clusters. The `superusers` group has full access.
</Tip>

### Export for review

Preview the Kubernetes resources without applying:

```bash
cpln operator install \
  --serviceaccount k8s-operator \
  --export \
  --org my-org
```

You can save and apply them manually:

```bash
cpln operator install --serviceaccount k8s-operator --export --org my-org > operator-secret.yaml
kubectl apply -f operator-secret.yaml
```

## Uninstall the operator

Remove the operator secret from your cluster:

```bash
cpln operator uninstall --org my-org
```

This:
1. Finds the secret in the `controlplane` namespace (identified by annotation)
2. Deletes the secret
3. Exits with code 0 if the secret doesn't exist

<Note>
The service account in Control Plane is not deleted. Remove it separately if needed.
</Note>

## Troubleshooting

<AccordionGroup>
<Accordion title="Installation fails with secret conflict">
  A secret with the organization name already exists but wasn't created by the operator. Either:
  - Delete the existing secret manually
  - Use a different organization name
</Accordion>

<Accordion title="Permission denied">
  Ensure your `kubectl` context has permissions to create secrets in the `controlplane` namespace:

  ```bash
  kubectl auth can-i create secrets --namespace controlplane
  ```
</Accordion>

<Accordion title="Namespace doesn't exist">
  Create the `controlplane` namespace if it doesn't exist:

  ```bash
  kubectl create namespace controlplane
  ```
</Accordion>
</AccordionGroup>

## Next steps

<CardGroup cols={2}>
  <Card title="Convert K8s Manifests" href="/guides/cli/cpln-convert" icon="right-left">
    Convert Kubernetes resources to Control Plane
  </Card>
  <Card title="Apply YAML Manifests" href="/guides/cpln-apply" icon="file-code">
    Deploy resources from YAML files
  </Card>
  <Card title="Service Accounts" href="/guides/create-service-account" icon="key">
    Manage service account permissions
  </Card>
  <Card title="Command Reference" href="/cli-reference/commands/operator" icon="book">
    Full operator command reference
  </Card>
</CardGroup>
