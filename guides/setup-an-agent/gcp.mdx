---
title: GCP
---

### Overview

Follow the steps below to install and configure an [agent](/reference/agent) within your Google Cloud Platform (GCP) environment.

### Prerequisites

- Review the [Agent](/reference/agent) reference page
- [Google Cloud Platform (GCP)](https://cloud.google.com/) account.

### Step One - Create an Agent

Follow the [Create an Agent](/guides/agent) guide to define an agent and generate the bootstrap config file that will be used in
[step two](#step-two-launch-agent-in-gcp).

### Step Two - Launch agent in GCP

- Using the Google Cloud SDK

1. Install the latest [SDK](https://cloud.google.com/sdk/docs/install).
2. If necessary, log in using `gcloud init`.
3. Execute the command in the note below. Ensure that the instance will be deployed in the same VPC and region as your GCP resources. Use a unique `INSTANCE_NAME` and the bootstrap file `(AGENT_NAME-bootstrapConfig.json)` that was created in [step one](#step-one-create-an-agent-3).

```
gcloud compute instances create **INSTANCE_NAME** --image controlplane-agent-1875-1559894088-47d5d1215 --image-project cpln-build --metadata-from-file=user-data=**AGENT_NAME-bootstrapConfig.json**
```

<Tip>
Refer to the [Agent Sizing Guidance](/reference/agent#agent-sizing-guidance) page for additional details on which machine type to select.

Add the flag `--machine-type=MACHINE_TYPE` to the command above to select a different type. Otherwise, the default type is `n1-standard-1`.

</Tip>

4. After a few moments, the command will return and show the status of the deployed instance.
5. The agent will now be running, connecting to the Control Plane servers, and ready to process requests.

### Step Three - Configure Firewall

By default, the GCP firewall rules open the common SSH, RDP, and ICMP ports to the world and allows all internal ports within the VPC. The agent does not need any of these ports open.

At a minimum, the agent needs to be able to connect to your GCP resources and the Internet.

### Next Steps

Now that you have an agent configured and running, it can be used within an [identity](/reference/identity) to allow your [workload](/reference/workload) to connect to your internal GCP resources.

## Private Network

### Overview

Follow the steps below to install and configure an [agent](/reference/agent) within your private network.

### Prerequisites

- Review the [Agent](/reference/agent) reference page.
- Install the [CLI](/reference/cli).
- Install [Docker](https://docs.docker.com/engine/install/)

### Step One - Create an Agent

Follow the [Create an Agent](/guides/agent) guide to define an agent and generate the bootstrap config file that will be used in
[step two](#step-two-launch-agent-locally).

### Step Two - Launch agent locally

1. Open a new shell and execute the following command. Use the bootstrap file that was created in [step one](#step-one-create-an-agent-4).

```
cpln agent up --bootstrap-file=PATH/AGENT_NAME-bootstrapConfig.json
```

<Tip>

If you are using Windows, follow these instructions:

- Configure Docker to **not** use the WSL 2 based engine.
- Run the `cpln` command above using a Windows command prompt and not using WSL.

</Tip>

2. The agent will now be running, connecting to the Control Plane servers, and ready to process requests.

### Next Steps

Now that you have an agent configured and running, it can be used within an [identity](/reference/identity) to allow your [workload](/reference/workload) to connect to your local resources.

<Tip>
  When running an agent locally, it is running within a local Docker container. When configuring an [identity network
  resource](/reference/identity#network-resources-cloud-wormhole), you must use the IP of the network adapter that Docker installed on the
  local machine.
</Tip>
