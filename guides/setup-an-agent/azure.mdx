---
title: Azure
---

### Overview

Follow the steps below to install and configure an [agent](/reference/agent) within your Microsoft Azure environment.

### Prerequisites

- Review the [Agent](/reference/agent) reference page
- [Microsoft Azure](https://azure.com) account

### Step One - Create an Agent

Follow the [Create an Agent](/guides/agent) guide to define an agent and generate the bootstrap config file that will be used in
[step two](#step-two-launch-an-agent-in-azure).

### Step Two - Launch an agent in Azure

1. Log in to the [Azure Console](https://portal.azure.com).
2. From the Azure homepage, click the `Marketplace` icon.
3. In the Marketplace search bar, enter:

```
Control Plane Secure Communications Agent
```

4. Press `Enter`.
5. When clicking the `Create` dropdown, select `gen-1`.
6. Use these recommended settings for the `Create a virtual machine` wizard:

- Basic
  - Subscription: Choose the appropriate subscription.
  - Resource Group: Choose the appropriate resource group. If necessary, create a new one.
  - Virtual machine name: Enter `Control-Plane-Agent-01`. If installing multiple agents, increment the number.
  - Region: Select a region closest to your other Azure resources.
  - Availability options: Select `No infrastructure redundancy required`. Use a different option for your environment if you are running in production.
  - Image: Leave as `gen-1`.
  - Size: An instance with at least 2 vCPUs and 4 GiB of memory is recommended for optimal performance.
  - Authentication type: Select `SSH public key`.
  - Username: Leave as `azureuser`.
  - SSH public key source: Choose the appropriate key. If necessary, create a new one.
  - Key pair name: Select appropriate key, or if creating a new one, use the default or update the key name.
  - Public inbound ports: Select `None`. The agent does not need any inbound ports open.
  - Click `Next: Disks`.
- Disks
  - OS disk type: Select `Premium SSD`.
  - Encryption type: Select `(Default) Encryption at-rest with a platform-managed key`.
  - Click `Next: Networking`.
- Networking
  - Virtual network: Choose an appropriate network or use the new network that will be created.
  - Subnet: Choose appropriate network or use the default.
  - Public IP: Select `None`.
  - NIC network security group: Select `Basic`.
  - Public inbound ports: Select `None`.
  - Click `Next: Management`.
- Management
  - Enable basic plan for free: Enabled.
  - Boot diagnostics: Select `Enable with managed storage account`.
  - Enable OS guest diagnostics: Disabled.
  - System assigned managed identity: Disabled.
  - Enable auto-shutdown: Disabled.
  - Patch orchestration options: Select `Image default`.
  - Click `Next: Advanced`.
- Advanced
  - Custom data: Paste the JSON text generated from [Step One](#step-one-create-an-agent-2) into the textbox.
  - Click `Next: Tags`.
- Tags
  - Optional: Enter any necessary tags.
  - Click `Next: Review + create`.
- Review + create
  - Review all the settings and enter any missing values.
  - Click `Create`.
  - If you requested to create a new key pair, a modal will pop-up requesting to download the private key. Click `Download private key and create resource`.

The agent virtual machine will begin the deployment process. After a few moments, the agent will be running, connecting to the Control Plane servers, and ready to process requests.

### Next Steps

Now that you have an agent configured and running, it can be used within an [identity](/reference/identity) to allow your
[workload](/reference/workload) to connect to your internal Azure resources.
